\newpage

\section{Design and implementation of NEAT}

\subsection{Overview}

\subsection{Verification of functionality}
XOR is not linearly separable, which imposes some requirements on the ANN structures that can solve it.
This makes XOR a suitable problem for verifying that the implementation is somewhat correct and can evolve
the required structure - a sanity check. Another advantage is that it provides a direct way to compare my
implementation of NEAT with the original one, since the XOR results for it were published \cite{neat_main}.

%\input{resources/tex/xor/separable.tex}

Each network was evaluated with the four XOR input examples and assigned a fitness according to the following expression
\begin{equation*} \label{eq:1}
    (4 - \sum_{i=1}^{4} expected_{i} - actual_{i})^2
\end{equation*}
where $expected_{i}$ is the correct answer for example $i$ and $actual_{i}$ is the actual output of the network for example $i$.

Data was collected from 100 runs. Each run was terminated once a network was found that solved
XOR or the number of network evaluations exceeded 20 000. The parameters used can be found in appendix \ref{parameter_values}.

\begin{table}[H]
    \centering
    \sisetup{table-format = 3.2}
    \begin{tabular}{lSS}
    \toprule
    Statistic & \multicolumn{1}{l}{Implementation} & \multicolumn{1}{l}{Original \cite{neat_main}} \\
    \midrule
    \rowcolor[gray]{.9} Mean evaluations & 4046 & 4755\\
    Standard deviation & 2316 & 2553\\
    \rowcolor[gray]{.9} Mean hidden nodes & 3.03 & 2.35\\
    Standard deviation & 1.49 & 1.11\\
    \rowcolor[gray]{.9} Mean links & 12.73 & 7.48\\
    Standard deviation & 3.78 & NaN\\
    Failures & 0 & 0\\
    Worst performance (evaluations) & 14355 & 13459 \\
    Minimal structures found & 14 & 22\\
    \bottomrule
    \end{tabular}
    \smallskip
    \caption{Comparison of performance on XOR with the original NEAT.}
\end{table}
\vspace{-1.5em}
The results are overall similar. While my implementation finds solutions in fewer
evaluations more consistently (see Figure \ref{evals}), the networks are on average larger
and fewer minimal structures are found. Besides the link and node mutation rates, the
parameters used were identical.

\todo{Add figure with: truth vals of XOR, plot of XOR and minimal network able to solve XOR (show weights!)}

\begin{figure}
    \centering
    \input{resources/results/xor_evals.pgf}
    \caption{Histogram of the number of evaluated networks before XOR was solved over 100 runs. The width of each bin is 1000.}
    \label{evals}
\end{figure}